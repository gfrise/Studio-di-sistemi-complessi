(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15101,        386]
NotebookOptionsPosition[     13618,        355]
NotebookOutlinePosition[     14010,        371]
CellTagsIndexPosition[     13967,        368]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.926044557608412*^9, 3.926044559675556*^9}, {
  3.92604462224214*^9, 3.926044632203372*^9}, {3.926044813104495*^9, 
  3.9260448164606733`*^9}, {3.9260451714215612`*^9, 
  3.9260451831797047`*^9}},ExpressionUUID->"58f7d599-bc91-4a9b-be7f-\
1ef66ed0b65a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"k", ",", "l"}], "]"}], " ", "transizione", " ", "tra", " ", 
    "gli", " ", "stati"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ST", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<F\>\"", ",", "\"\<L\>\""}], "}"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"ns", "=", 
    RowBox[{"Length", "[", "ST", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "=", "0.95"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "=", "0.05"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "=", "0.1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "=", "0.9"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.926044603364616*^9, 3.9260446081368923`*^9}, {
   3.926044660847218*^9, 3.9260446893344107`*^9}, {3.9260451056874104`*^9, 
   3.926045121414906*^9}, 3.926045172801939*^9, {3.926049088388085*^9, 
   3.92604913203971*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"84b8b8d8-3c50-43db-adcf-cf5768e674de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"F\"\>", ",", "\<\"L\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.926049124354239*^9, 3.926049132483893*^9}},
 CellLabel->
  "Out[216]=",ExpressionUUID->"f333d551-5ab3-47fb-bef5-fc252917ca66"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.926049124354239*^9, 3.926049132485111*^9}},
 CellLabel->
  "Out[217]=",ExpressionUUID->"d0ee5eef-fe3f-4c30-a2e3-e5baad781ff3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"e", " ", "nello", " ", "stato"}], ",", 
    RowBox[{"la", " ", "prob", " ", "del", " ", "nucleotide"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"A", " ", "alfabeto"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nn", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", 
         RowBox[{"A", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
       RowBox[{
        RowBox[{"1", "/", "6"}], "//", "N"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "     ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nn"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", 
         RowBox[{"A", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
       RowBox[{
        RowBox[{"1", "/", "10"}], "//", "N"}]}], ";"}], ",", 
     "\[IndentingNewLine]", "     ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"nn", "-", "1"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"2", ",", 
       RowBox[{"A", "[", 
        RowBox[{"[", "nn", "]"}], "]"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "//", "N"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.92604453117309*^9, 3.926044651102927*^9}, {
  3.926045124669519*^9, 3.926045141053793*^9}, {3.926045179306151*^9, 
  3.926045215037718*^9}, {3.9260453232545023`*^9, 3.926045390182131*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"6adc0ca4-6d8b-4719-a167-087ba178652e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nT", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EMP", "=", 
  RowBox[{"{", 
   RowBox[{
   "3", ",", "1", ",", "5", ",", "1", ",", "1", ",", "6", ",", "2", ",", "4", 
    ",", "6", ",", "4", ",", "4", ",", "6", ",", "6", ",", "4", ",", "4", ",",
     "2", ",", "4", ",", "5", ",", "3", ",", "1", ",", "1", ",", "3", ",", 
    "2", ",", "1", ",", "6", ",", "3", ",", "1", ",", "1", ",", "3", ",", "4",
     ",", "1", ",", "5", ",", "2", ",", "1", ",", "3", ",", "3", ",", "6", 
    ",", "2", ",", "5", ",", "1", ",", "4", ",", "4", ",", "5", ",", "4", ",",
     "3", ",", "6", ",", "3", ",", "1", ",", "6", ",", "5", ",", "6", ",", 
    "6", ",", "2", ",", "6", ",", "5", ",", "6", ",", "6", ",", "6", ",", "6",
     ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"nT", "=", 
  RowBox[{"Length", "[", "EMP", "]"}]}]}], "Input",
 CellChangeTimes->{{3.926045954781981*^9, 3.926046000150888*^9}, {
  3.926046142087988*^9, 3.9260461882554607`*^9}, {3.926046252392611*^9, 
  3.926046321315981*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"a40f76b3-e9d6-411d-ae2f-bbac1b23f495"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "1", ",", "5", ",", "1", ",", "1", ",", "6", ",", "2", ",", "4", 
   ",", "6", ",", "4", ",", "4", ",", "6", ",", "6", ",", "4", ",", "4", ",", 
   "2", ",", "4", ",", "5", ",", "3", ",", "1", ",", "1", ",", "3", ",", "2", 
   ",", "1", ",", "6", ",", "3", ",", "1", ",", "1", ",", "3", ",", "4", ",", 
   "1", ",", "5", ",", "2", ",", "1", ",", "3", ",", "3", ",", "6", ",", "2", 
   ",", "5", ",", "1", ",", "4", ",", "4", ",", "5", ",", "4", ",", "3", ",", 
   "6", ",", "3", ",", "1", ",", "6", ",", "5", ",", "6", ",", "6", ",", "2", 
   ",", "6", ",", "5", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.926046321925963*^9, 3.9260463753560457`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"33bf8b56-ed32-4c04-927a-f4ff834e56f7"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{3.926046321925963*^9, 3.926046375357264*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"5e43162b-d479-48e7-a454-2795a58b01ca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "k", " ", "indica", " ", "gli", " ", "stati", "\[IndentingNewLine]", " ", 
     "i", " ", "indica", " ", "il", " ", "tempo", " ", 
     RowBox[{"(", 
      RowBox[{"posizione", " ", "nel", " ", "genoma"}], ")"}], 
     "\[IndentingNewLine]", " ", "a", " ", "transizione", " ", "tra", " ", 
     "gli", " ", "stati", "\n", "  ", "e", " ", "nello", " ", "stato"}], ",", 
    
    RowBox[{
    "la", " ", "prob", " ", "del", " ", "nucleotide", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"V", "[", 
      RowBox[{"k", ",", "i"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "V", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"k", ",", "0"}], "]"}], "=", "0"}], ",", "\[IndentingNewLine]",
      "   ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "2", ",", "ns"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.926044819375102*^9, 3.9260448772638187`*^9}, {
  3.926044944035644*^9, 3.926045011901915*^9}, {3.926045186690095*^9, 
  3.926045187147895*^9}, {3.926045937482069*^9, 3.926045949299313*^9}, {
  3.9260468246186132`*^9, 3.9260468287941093`*^9}, {3.926047124732695*^9, 
  3.926047127957238*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"fa4bacef-af06-4c45-a589-bb742951201a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Viterbi", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"k", ",", "i"}], "]"}], " ", "ci", " ", "dice", " ", 
     RowBox[{"qual", "'"}], "\[EGrave]", " ", "la", " ", 
     "probabilit\[AGrave]", " ", "di", " ", "avere", " ", "lo", " ", "stato", 
     " ", "k"}], "-", 
    RowBox[{"esimo", " ", "al", " ", "tempo", " ", "i"}], "-", 
    RowBox[{"esimo", " ", "nella", " ", "sequanza", " ", "consenso"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"V", "[", 
          RowBox[{"j", ",", "i"}], "]"}], "=", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"j", ",", 
            RowBox[{"EMP", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"V", "[", 
                RowBox[{"k", ",", 
                 RowBox[{"i", "-", "1"}]}], "]"}], "*", 
               RowBox[{"a", "[", 
                RowBox[{"k", ",", "j"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "ns"}], "}"}]}], "]"}], "//", 
            "Max"}], ")"}]}]}], ";"}], ",", "\[IndentingNewLine]", 
       "         ", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "ns"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "     ", 
     RowBox[{"max", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"V", "[", 
          RowBox[{"j", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "ns"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "     ", 
     RowBox[{"pos", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"V", "[", 
            RowBox[{"j", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "ns"}], "}"}]}], "]"}], ",", "max"}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "     ", 
     RowBox[{
      RowBox[{"state", "[", "i", "]"}], "=", 
      RowBox[{"ST", "[", 
       RowBox[{"[", "pos", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "    ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nT"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.92604502574496*^9, 3.9260450644207563`*^9}, {
   3.926045398653419*^9, 3.926045404472425*^9}, {3.926045483933875*^9, 
   3.926045495649146*^9}, {3.926045872872279*^9, 3.9260459229040413`*^9}, {
   3.92604640397059*^9, 3.9260464069249277`*^9}, {3.926046463226502*^9, 
   3.926046470410338*^9}, {3.9260465741614037`*^9, 3.9260465895415382`*^9}, {
   3.926046721666305*^9, 3.92604674094296*^9}, {3.926046843271266*^9, 
   3.926046848259739*^9}, {3.926046897078723*^9, 3.926046897473349*^9}, {
   3.9260478300113373`*^9, 3.926047842809086*^9}, {3.926047939700923*^9, 
   3.926047941701518*^9}, {3.926048198240814*^9, 3.926048211258321*^9}, {
   3.9260487103678637`*^9, 3.9260487530667257`*^9}, 3.92604879428776*^9, {
   3.926049015110731*^9, 3.926049025479323*^9}, {3.926049057531152*^9, 
   3.926049072981124*^9}, {3.926049158412936*^9, 3.926049197060707*^9}, {
   3.926049245469149*^9, 3.926049298599264*^9}, {3.926049348741088*^9, 
   3.9260493509488297`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"a09dbcb0-1ae2-4667-94a1-560ef7d83468"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"state", "[", "i", "]"}], ",", "\[IndentingNewLine]", "    ", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nT"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.926049366539774*^9},
 CellLabel->
  "In[246]:=",ExpressionUUID->"aebf5e42-95b9-48f9-b474-efaaa66a54d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", ",", "\<\"F\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"L\"\>", ",", "\<\"F\"\>", ",", "\<\"L\"\>", 
   ",", "\<\"L\"\>", ",", "\<\"L\"\>", ",", "\<\"L\"\>", ",", "\<\"L\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.926049367095155*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"4af2eafe-32bb-47a9-b647-828730d607cf"]
}, Open  ]]
},
WindowSize->{1462, 974},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a3284fe0-86a8-4ec2-82ce-2d2c34867cd1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 301, 5, 30, "Input",ExpressionUUID->"58f7d599-bc91-4a9b-be7f-1ef66ed0b65a"],
Cell[CellGroupData[{
Cell[884, 29, 1291, 38, 157, "Input",ExpressionUUID->"84b8b8d8-3c50-43db-adcf-cf5768e674de"],
Cell[2178, 69, 238, 5, 34, "Output",ExpressionUUID->"f333d551-5ab3-47fb-bef5-fc252917ca66"],
Cell[2419, 76, 177, 3, 34, "Output",ExpressionUUID->"d0ee5eef-fe3f-4c30-a2e3-e5baad781ff3"]
}, Open  ]],
Cell[2611, 82, 1948, 57, 199, "Input",ExpressionUUID->"6adc0ca4-6d8b-4719-a167-087ba178652e"],
Cell[CellGroupData[{
Cell[4584, 143, 1130, 21, 73, "Input",ExpressionUUID->"a40f76b3-e9d6-411d-ae2f-bbac1b23f495"],
Cell[5717, 166, 836, 14, 34, "Output",ExpressionUUID->"33bf8b56-ed32-4c04-927a-f4ff834e56f7"],
Cell[6556, 182, 176, 3, 34, "Output",ExpressionUUID->"5e43162b-d479-48e7-a454-2795a58b01ca"]
}, Open  ]],
Cell[6747, 188, 1506, 38, 199, "Input",ExpressionUUID->"fa4bacef-af06-4c45-a589-bb742951201a"],
Cell[8256, 228, 3671, 90, 178, "Input",ExpressionUUID->"a09dbcb0-1ae2-4667-94a1-560ef7d83468"],
Cell[CellGroupData[{
Cell[11952, 322, 330, 8, 52, "Input",ExpressionUUID->"aebf5e42-95b9-48f9-b474-efaaa66a54d5"],
Cell[12285, 332, 1317, 20, 34, "Output",ExpressionUUID->"4af2eafe-32bb-47a9-b647-828730d607cf"]
}, Open  ]]
}
]
*)

